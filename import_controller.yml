---
- name: Import Controller assets from a previously exported yml file generated by awx.awx.export
  hosts: localhost
  connection: local
  gather_facts: false

  tasks:
    - name: Set input filename
      ansible.builtin.set_fact:
        output_filename: output_controller_assets.yml

    - name: Read assets from file {{  output_filename }}
      ansible.builtin.include_vars:
        name: all_assets
        file: "{{  output_filename }}"

    - name: Import all assets
      awx.awx.import:
        assets: "{{ all_assets.assets }}"
        controller_host: "{{ controller_host_dest }}"
        controller_username: "{{ controller_user_dest }}"
        controller_password: "{{ controller_pwd_dest }}"
        #controller_oauthtoken: "{{ controller_token_dest }}"
        validate_certs: False
